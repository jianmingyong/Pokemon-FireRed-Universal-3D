version=2
##############################
# Sub Global.Main
##############################

@Storage.set(str,StackTrace.Set,Version\2\Class\Global\Main.dat)
@Script.start(Version\2\Class\StackTrace\Set)

:if:<Storage.get(bool,Security.FileValidation.Checks)>=true
	@Storage.set(bool,Security.FileValidation.ScriptExist,true)
	:end
:endif

# Reset Screen.
@Title.clear
@Camera.defix
@Screen.fadein
@Level.update

:if:<Storage.get(bool,Global.Main.Start)>=false
	# Stop the music.
	@Music.play(Stop)
	
	# Update Game.
	@Script.start(Version\2\Class\Update\v0.54.0.0.0.16)
	@Script.start(Version\2\Class\Global\Register)
	
	# Initalize Language.
	@Script.start(Version\2\Class\Localization\Main)
	:if:<not><Register.value(Global.Token)>=English
		@Script.start(Version\2\Class\Localization\<Register.value(Global.Token)>)
	:endif
	@Script.start(Version\2\Class\Localization\English)
	
	# Save Game.
	@Script.start(Version\2\Class\Global\Save)
	
	# File Validation.
	@Script.start(Version\2\Class\Security\FileValidation)
	
	# Start Main Menu Screen.
	@Script.start(Version\2\Class\Screen\TitleScreen)
	
	@Storage.set(bool,Global.Main.Start,true)
:else
	@Script.start(<filesystem.pathup(<Level.levelfile>)>\<Level.filename>)
:endif
:end